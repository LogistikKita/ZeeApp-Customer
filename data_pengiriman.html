<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Pengiriman | Logistik Kita</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .sidebar-collapsed .sidebar-label {
      display: none;
    }
    .sidebar {
      transition: width 0.3s ease;
    }
    .sidebar-expanded {
      width: 260px;
    }
    .sidebar-collapsed {
      width: 80px;
    }
  </style>
</head>
<body class="bg-gray-100">
<div class="flex min-h-screen">
  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar sidebar-expanded bg-black text-white flex flex-col p-4 space-y-6">
    <div class="flex items-center justify-between">
      <div class="flex flex-col items-start">
        <img src="logo_logistikkita.png" alt="Logo" class="h-10 mb-2" />
        <h1 class="sidebar-label text-xl font-bold text-red-500">Logistik Kita</h1>
      </div>
      <button onclick="toggleSidebar()" class="text-white">
        <i class="ph ph-list text-2xl"></i>
      </button>
    </div>
    <nav class="flex flex-col gap-2 mt-4">
      <a href="#" class="flex items-center gap-2 text-sm hover:bg-red-600 px-3 py-2 rounded">
        <i class="ph ph-gauge"></i> <span class="sidebar-label">Dashboard</span>
      </a>
      <a href="#" class="flex items-center gap-2 text-sm bg-red-600 px-3 py-2 rounded">
        <i class="ph ph-truck"></i> <span class="sidebar-label">Data Pengiriman</span>
      </a>
      <!-- Menu lainnya -->
    </nav>
  </aside>  <!-- Main Content -->  <main class="flex-1 p-6">
    <header class="mb-6">
      <h2 class="text-2xl font-bold text-red-600">Data Pengiriman</h2>
      <p class="text-sm text-gray-600">Lihat dan kelola data pengiriman barang.</p>
    </header><!-- Filter Bulan -->
<div class="mb-4">
  <h3 class="font-semibold mb-2">Pilih Bulan:</h3>
  <div class="grid grid-cols-3 md:grid-cols-6 gap-2">
    <button class="btn btn-sm btn-outline" onclick="filterBulan(1)">Januari</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(2)">Februari</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(3)">Maret</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(4)">April</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(5)">Mei</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(6)">Juni</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(7)">Juli</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(8)">Agustus</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(9)">September</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(10)">Oktober</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(11)">November</button>
    <button class="btn btn-sm btn-outline" onclick="filterBulan(12)">Desember</button>
  </div>
</div>

<!-- Tabel Data Pengiriman -->
<div id="dataContainer" class="overflow-auto"></div>

  </main>
</div><script>
  function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('sidebar-collapsed');
    sidebar.classList.toggle('sidebar-expanded');
  }

  async function filterBulan(bulan) {
    const SUPABASE_URL = "https://mrghlcedtafomwnznywf.supabase.co";
    const SUPABASE_API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yZ2hsY2VkdGFmb213bnpueXdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMTAwMTcsImV4cCI6MjA2NTg4NjAxN30.vCLC9w8sT0-4uMLFt9c-3BsFeLVco68ajtsu2ZQUiWs";

    const tahun = new Date().getFullYear();
    const awal = `${tahun}-${String(bulan).padStart(2, '0')}-01`;
    const akhir = `${tahun}-${String(bulan).padStart(2, '0')}-31`;

    const res = await fetch(`${SUPABASE_URL}/rest/v1/Data_Barang?select=*&tanggal_masuk=gte.${awal}&tanggal_masuk=lte.${akhir}`, {
      headers: {
        apikey: SUPABASE_API_KEY,
        Authorization: `Bearer ${SUPABASE_API_KEY}`
      }
    });

    const data = await res.json();
    renderTabel(data);
  }

  function renderTabel(data) {
    const container = document.getElementById("dataContainer");
    if (!data.length) {
      container.innerHTML = '<p class="text-gray-500">Tidak ada data di bulan ini.</p>';
      return;
    }

    let html = `<div class="overflow-x-auto"><table class="min-w-full bg-white rounded-xl shadow"><thead><tr class="bg-red-600 text-white text-left text-sm">
      <th class="py-2 px-4">Tanggal</th>
      <th class="py-2 px-4">Customer</th>
      <th class="py-2 px-4">Tujuan</th>
      <th class="py-2 px-4">Barang</th>
      <th class="py-2 px-4">Tarif</th>
      <th class="py-2 px-4">Status</th>
      <th class="py-2 px-4">Aksi</th>
    </tr></thead><tbody>`;

    data.forEach(item => {
      html += `<tr class="border-b text-sm">
        <td class="py-2 px-4">${item.tanggal_masuk}</td>
        <td class="py-2 px-4">${item.nama_customer}</td>
        <td class="py-2 px-4">${item.tujuan_kirim}</td>
        <td class="py-2 px-4">${item.nama_barang}</td>
        <td class="py-2 px-4">Rp ${item.tarif_pengiriman.toLocaleString("id-ID")}</td>
        <td class="py-2 px-4">${item.status_kirim}</td>
        <td class="py-2 px-4">
          <button onclick='alert(JSON.stringify(${JSON.stringify(item)}, null, 2))' class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded">Detail</button>
        </td>
      </tr>`;
    });

    html += `</tbody></table></div>`;
    container.innerHTML = html;
  }
</script></body>
</html>
