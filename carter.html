<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulasi Carter - Logistik Kita</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">
  <div class="container mt-4 mb-5">
    <h3 class="mb-3">üöõ Simulasi Tarif Carter</h3>

    <!-- Lokasi Garasi -->
    <div class="mb-3">
      <label class="form-label">Lokasi Garasi (default)</label>
      <input type="text" class="form-control" value="Garasi Logistik Kita" disabled>
      <input type="number" class="form-control mt-2" value="0" disabled>
    </div>

    <!-- Lokasi Penjemputan -->
    <div id="pickup-section" class="mb-3">
      <label class="form-label">Lokasi Penjemputan / Muat</label>
      <div class="row g-2 mb-2">
        <div class="col">
          <input type="text" class="form-control" placeholder="Lokasi Penjemputan 1">
        </div>
        <div class="col-3">
          <input type="number" class="form-control" placeholder="Jarak dari Garasi (km)">
        </div>
      </div>
    </div>
    <button onclick="addPickup()" class="btn btn-outline-secondary btn-sm mb-3">+ Tambah Lokasi Penjemputan</button>

    <!-- Lokasi Bongkar -->
    <div id="drop-section" class="mb-3">
      <label class="form-label">Lokasi Antar / Bongkar</label>
      <div class="row g-2 mb-2">
        <div class="col">
          <input type="text" class="form-control" placeholder="Lokasi Bongkar 1">
        </div>
        <div class="col-3">
          <input type="number" class="form-control" placeholder="Jarak dari Penjemputan terakhir (km)">
        </div>
      </div>
    </div>
    <button onclick="addDrop()" class="btn btn-outline-secondary btn-sm mb-3">+ Tambah Lokasi Bongkar</button>

    <!-- Kembali ke garasi -->
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="returnSwitch" onchange="toggleReturnInput()">
      <label class="form-check-label" for="returnSwitch">Kembali ke Garasi</label>
    </div>
    <div id="return-section" class="row g-2 mb-3 d-none">
      <div class="col">
        <input type="text" class="form-control" value="Garasi Logistik Kita" disabled>
      </div>
      <div class="col-3">
        <input type="number" class="form-control" placeholder="Jarak (km)" id="return-distance">
      </div>
    </div>

    <!-- Tombol Cek Tarif -->
    <button class="btn btn-danger w-100" onclick="showResult()">Cek Tarif</button>
  </div>

  <!-- Modal Hasil -->
  <div class="modal fade" id="resultModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">üì¶ Estimasi Tarif Carter Anda</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="resultBody"></div>
        <div class="modal-footer">
          <small class="text-muted">
            * Estimasi tarif belum termasuk biaya TKBM<br>
            * Hubungi Admin Logistik Kita untuk info selengkapnya
          </small>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap & JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function addPickup() {
      const html = `
        <div class="row g-2 mb-2">
          <div class="col">
            <input type="text" class="form-control" placeholder="Lokasi Penjemputan">
          </div>
          <div class="col-3">
            <input type="number" class="form-control" placeholder="Jarak (km)">
          </div>
        </div>`;
      document.getElementById('pickup-section').insertAdjacentHTML('beforeend', html);
    }

    function addDrop() {
      const html = `
        <div class="row g-2 mb-2">
          <div class="col">
            <input type="text" class="form-control" placeholder="Lokasi Bongkar">
          </div>
          <div class="col-3">
            <input type="number" class="form-control" placeholder="Jarak (km)">
          </div>
        </div>`;
      document.getElementById('drop-section').insertAdjacentHTML('beforeend', html);
    }

    function toggleReturnInput() {
      document.getElementById('return-section').classList.toggle('d-none');
    }

    function showResult() {
      const pickupInputs = document.querySelectorAll('#pickup-section .row');
      const dropInputs = document.querySelectorAll('#drop-section .row');
      let totalKM = 0;
      let route = ['1. Garasi (Logistik Kita)'];

      pickupInputs.forEach((row, i) => {
        const loc = row.querySelector('input[type="text"]').value || `Penjemputan ${i+1}`;
        const km = Number(row.querySelector('input[type="number"]').value || 0);
        totalKM += km;
        route.push(`${i+2}. ${loc} (${km} km)`);
      });

      dropInputs.forEach((row, i) => {
        const loc = row.querySelector('input[type="text"]').value || `Bongkar ${i+1}`;
        const km = Number(row.querySelector('input[type="number"]').value || 0);
        totalKM += km;
        route.push(`${pickupInputs.length + i + 2}. ${loc} (${km} km)`);
      });

      if (document.getElementById('returnSwitch').checked) {
        const returnKM = Number(document.getElementById('return-distance').value || 0);
        totalKM += returnKM;
        route.push(`${route.length + 1}. Kembali ke Garasi (${returnKM} km)`);
      }

      // Tarif estimasi
      const bbmPerLiter = 10000;
      const kmPerLiter = 9;
      const sewa = 200000;
      const margin = 50000;
      const bbmCost = Math.ceil((totalKM / kmPerLiter) * bbmPerLiter);
      const totalTarif = bbmCost + sewa + margin;

      const resultText = `
        <p>üîÅ Rute:</p>
        <ul>${route.map(r => `<li>${r}</li>`).join('')}</ul>
        <p>üìè Total Jarak Tempuh: <strong>${totalKM} km</strong></p>
        <p>üí∞ Estimasi Tarif Carter: <strong>Rp${totalTarif.toLocaleString('id-ID')}</strong></p>
      `;

      document.getElementById('resultBody').innerHTML = resultText;
      new bootstrap.Modal(document.getElementById('resultModal')).show();
    }
  </script>
</body>
</html>
